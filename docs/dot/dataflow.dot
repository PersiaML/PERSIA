digraph G {

  subgraph cluster0 {
    sc0[label="SenderChannel"];
    df[label="RPC DataFlow Service"];
    df -> sc0;
    label = "StreamingDataset";
  }

  subgraph cluster1 {
    iter[label="Iterable[PersiaBatch]"];
    sc1[label="SenderChannel"];
    iter -> sc1;
    label = "IterableDataset";
  }
  
  
  subgraph cluster2 {
      label = "DataLoader";
      r0[label="ReceiverChannel"];
      output[label="OutputChannel"]
      l0[label="lookup_embedding_worker0"];
      l1[label="lookup_embedding_worker1"];
      l2[label="lookup_embedding_worker2"];
      p0[label="postprocess_worker0"];
      p1[label="postprocess_worker1"];
      p2[label="postprocess_worker2"];
      
      r0 -> l0;
      r0 -> l1;
      r0 -> l2;
      l0 -> p0;
      l0 -> p1;
      l0 -> p2;
      l1 -> p0;
      l1 -> p1;
      l1 -> p2;
      l2 -> p0;
      l2 -> p1;
      l2 -> p2;
      p0 -> output;
      p1 -> output;
      p2 -> output;
  }
  
  dcxt[label="DataCtx"];
  dcxt -> df[pos="left"];
  sc0 -> r0;
  sc1 -> r0;
}